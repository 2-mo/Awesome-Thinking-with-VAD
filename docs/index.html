<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tracing Video Anomaly Understanding</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & Babel -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Elegant Handwriting Fonts: Added Italianno -->
    <link href="https://fonts.googleapis.com/css2?family=Italianno&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --spine-color: rgba(255, 255, 255, 0.15);
            /* 分类配色 - 柔和发光 */
            --llm-color: #e5f0db;
            --vlm-color: #ddd2e9;
            --data-color: #e0ebf6;
            --llm-accent: #bef264;
            --vlm-accent: #c084fc;
            --data-accent: #7dd3fc;
            /* 默认深色模式配置 */
            --bg-color: #020617;
            --text-main: #f1f5f9;
            --text-muted: #94a3b8;
            --card-bg: rgba(15, 23, 42, 0.7);
            --badge-border: rgba(255,255,255,0.1);
            --llm-glow: rgba(190, 242, 100, 0.25);
            --vlm-glow: rgba(192, 132, 252, 0.25);
            --data-glow: rgba(125, 211, 252, 0.25);
            --img-filter: brightness(0.75) contrast(1.05);
            --modal-shadow: 0 0 50px rgba(0,0,0,0.8);
        }

        .light-theme {
            --bg-color: #fdfdfd;
            --text-main: #1e293b;
            --text-muted: #64748b;
            --card-bg: rgba(255, 255, 255, 0.85);
            --spine-color: rgba(0, 0, 0, 0.1);
            --llm-glow: rgba(61, 90, 66, 0.08);
            --vlm-glow: rgba(78, 67, 118, 0.08);
            --data-glow: rgba(44, 74, 112, 0.08);
            --badge-border: rgba(0,0,0,0.06);
            --img-filter: none;
            --modal-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15);
        }
        
        body { 
            font-family: 'Times New Roman', Times, serif !important;
            background-color: var(--bg-color);
            color: var(--text-main);
            overflow: hidden;
            transition: background-color 0.6s cubic-bezier(0.4, 0, 0.2, 1), color 0.6s ease;
        }

        .atlas-bg-base {
            position: fixed;
            inset: 0;
            z-index: -40;
            background: var(--bg-color);
            transition: background 0.6s ease;
        }

        .bing-bg {
            position: fixed;
            inset: 0;
            background-image: url('https://bing.biturl.top/?resolution=1920&format=image&index=0&mkt=zh-CN');
            background-size: cover;
            background-position: center;
            opacity: 0.12;
            filter: grayscale(0.6) brightness(0.4) contrast(1.2);
            z-index: -30;
            pointer-events: none;
            transition: filter 0.6s ease, opacity 0.6s ease;
        }
        .light-theme .bing-bg {
            opacity: 0.08;
            filter: grayscale(0.3) brightness(1.1) contrast(1.05);
        }

        #bg-canvas {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: -20;
            pointer-events: none;
        }

        .panorama-viewport {
            cursor: grab;
            user-select: none;
            overflow-x: auto;
            overflow-y: hidden;
        }
        .panorama-viewport:active { cursor: grabbing; }
        .no-scrollbar::-webkit-scrollbar { display: none; }

        .timeline-spine {
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--spine-color) 5%, var(--spine-color) 95%, transparent);
            position: absolute;
            top: 65%; left: 0; width: 100%;
            z-index: 0;
            transition: background 0.6s ease;
        }

        /* Updated Title Styling with Italianno */
        .atlas-handwritten-title {
            font-family: 'Italianno', cursive;
            font-size: 5.5rem;
            font-weight: 400;
            color: var(--text-main);
            opacity: 0.95;
            letter-spacing: 0.03em;
            line-height: 1;
            transition: color 0.6s ease;
        }
        .light-theme .atlas-handwritten-title {
            color: #1e293b;
        }

        .badge-tab-tech-cut {
            position: absolute;
            bottom: -1px; right: -1px;
            padding: 2px 10px 1px 12px;
            z-index: 30;
            clip-path: polygon(10px 0, 100% 0, 100% 100%, 0 100%, 0 10px);
            display: flex; align-items: center; justify-content: center;
        }

        .badge-text-flat {
            font-size: 7.2px; font-weight: 900; 
            text-transform: uppercase; font-family: sans-serif !important;
            line-height: 1;
            letter-spacing: 0.05em;
        }

        .card-glass {
            background-color: var(--card-bg);
            backdrop-filter: blur(8px);
            transition: all 0.5s cubic-bezier(0.16, 1, 0.3, 1);
            border: 1px solid rgba(255,255,255,0.06);
        }
        .light-theme .card-glass {
            border: 1px solid rgba(0,0,0,0.04);
        }

        .card-glass:hover {
            box-shadow: 
                0 20px 40px -15px rgba(0, 0, 0, 0.3),
                0 0 25px -2px var(--shadow-color); 
            transform: translateY(-8px); 
            border-color: rgba(255,255,255,0.15);
        }
        .light-theme .card-glass:hover {
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.03), 0 0 20px -2px var(--shadow-color);
            border-color: rgba(0,0,0,0.06);
        }

        img {
            filter: var(--img-filter);
            transition: filter 0.6s ease;
        }

        /* Top Action Bar Placement */
        .top-left-bar {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 100;
            display: flex;
            align-items: center;
        }

        .top-right-bar {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 100;
            display: flex;
            align-items: center;
        }

        .theme-toggle-btn {
            width: 32px;
            height: 32px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .light-theme .theme-toggle-btn { background: rgba(0,0,0,0.03); border-color: rgba(0,0,0,0.06); }
        .theme-toggle-btn:hover { background: rgba(255,255,255,0.1); color: #fff; transform: scale(1.05); }
        .light-theme .theme-toggle-btn:hover { background: rgba(0,0,0,0.06); color: #1e293b; }

        .star-tooltip {
            position: absolute;
            right: calc(100% + 14px);
            background: #0f172a;
            color: #fff;
            border: 1px solid rgba(255,255,255,0.1);
            padding: 6px 14px;
            border-radius: 8px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
            opacity: 0;
            transform: translateX(10px);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            pointer-events: none;
            white-space: nowrap;
            font-family: sans-serif;
            font-size: 9px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .light-theme .star-tooltip { background: #fff; color: #1e293b; border-color: rgba(0,0,0,0.08); }
        .github-link-group:hover .star-tooltip { opacity: 1; transform: translateX(0); }

        .bg-year-watermark {
            font-size: 26vw; font-weight: 900; font-family: 'Times New Roman', serif;
            font-style: italic; color: var(--text-main); opacity: 0.035; 
            pointer-events: none; white-space: nowrap; transition: opacity 0.6s ease, transform 0.6s ease;
        }
        .light-theme .bg-year-watermark { opacity: 0.008; }
        
        .nav-btn {
            background: rgba(255,255,255,0.03); backdrop-filter: blur(4px);
            border: 1px solid rgba(255,255,255,0.08); color: var(--text-muted);
            font-size: 10px; font-weight: 900; text-transform: uppercase;
            padding: 4px 18px; border-radius: 9999px; transition: all 0.3s ease;
        }
        .light-theme .nav-btn { background: white; border: 1px solid rgba(0,0,0,0.06); color: #64748b; }
        .nav-btn:hover { background: rgba(255,255,255,0.1); border-color: rgba(255,255,255,0.2); color: #fff; transform: translateY(-1px); }

        /* Pop-up design */
        .modal-container {
            background-color: var(--card-bg); backdrop-filter: blur(16px);
            border: 1px solid rgba(255,255,255,0.08);
            box-shadow: var(--modal-shadow);
        }
        
        .modal-close-trigger {
            position: absolute;
            top: 28px;
            right: 28px;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.1);
            color: #fff;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
            z-index: 120;
        }
        .light-theme .modal-close-trigger {
            background: rgba(0,0,0,0.03);
            border-color: rgba(0,0,0,0.08);
            color: #1e293b;
        }
        .modal-close-trigger:hover {
            background: rgba(239, 68, 68, 0.8);
            border-color: transparent;
            color: #fff;
            transform: rotate(90deg) scale(1.1);
        }
    </style>
</head>
<body class="selection:bg-indigo-900/30">
    <div class="atlas-bg-base"></div>
    <div class="bing-bg"></div>
    <canvas id="bg-canvas"></canvas>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo, Fragment, memo, useLayoutEffect } = React;

        const GITHUB_LINK = "https://github.com/2-mo/Awesome-Thinking-with-VAD";

        const CONF_THEMES = {
            "CVPR": "#60a5fa", "AAAI": "#f87171", "ICCV": "#818cf8", 
            "ECCV": "#fbbf24", "ACM MM": "#c084fc", "NeurIPS": "#34d399", 
            "ICML": "#6366f1", "DEFAULT": "#94a3b8"
        };

        const ACCENTS = {
            llm: { label: "Reasoning (LLM)", accent: "bg-[#bef264]", color: "#e5f0db", highlight: "#bef264", glow: "rgba(190, 242, 100, 0.3)" }, 
            clip: { label: "Multimodal (VLM)", accent: "bg-[#c084fc]", color: "#ddd2e9", highlight: "#c084fc", glow: "rgba(192, 132, 252, 0.3)" }, 
            dataset: { label: "Benchmark", accent: "bg-[#7dd3fc]", color: "#e0ebf6", highlight: "#7dd3fc", glow: "rgba(125, 211, 252, 0.3)" }   
        };

        const CONF_MONTHS = { "AAAI": 2, "CVPR": 6, "ICML": 7, "ECCV": 10, "ACM MM": 10, "ICCV": 10, "NeurIPS": 12 };

        // Fully reconstructed data based on provided image_87bde7.jpg
        const PAPER_DATA = [
            // 2023
            { name: "EVAL", title: "Explainable Video Anomaly Detection via Multi-Grained Reasoning", year: "2023", conf: "CVPR'23", type: "llm", logo: "https://upload.wikimedia.org/wikipedia/commons/4/40/Tsinghua_University_Logo.svg", anno: "Explainable VAD Architecture", arxiv: "https://arxiv.org/abs/2303.11111", github: "https://github.com/2-mo/EVAL" },
            { name: "PZAAR", title: "PZAAR: Contrastive Representation Learning for VAD", year: "2023", conf: "CVPR'23", type: "llm", logo: "https://upload.wikimedia.org/wikipedia/commons/1/13/Peking_University_Logo.svg", anno: "Contrastive Learning", arxiv: "https://arxiv.org/abs/2303.22222", github: "https://github.com/2-mo/PZAAR", badge: "CORE", level: 1 },
            
            // 2024
            { name: "VadCLIP", title: "VadCLIP: Vision-Language Models for VAD", year: "2024", conf: "AAAI'24", type: "clip", logo: "https://upload.wikimedia.org/wikipedia/commons/5/50/Emblem_of_CU.png", anno: "Multimodal Foundation", arxiv: "https://arxiv.org/abs/2308.11681", github: "https://github.com/ByZ0e/VadCLIP" },
            { name: "STPrompt", title: "STPrompt: Spatio-Temporal Prompting for Multimodal VAD", year: "2024", conf: "ACM MM'24", type: "clip", anno: "Spatio-Temporal Prompting" },
            { name: "TDSD", title: "Task-Driven Feature Distillation for ST Anomaly Detection", year: "2024", conf: "ACM MM'24", type: "clip", anno: "Distillation" },
            { name: "LAVAD", title: "LAVAD: Language-Augmented Training-Free VAD", year: "2024", conf: "CVPR'24", type: "llm", logo: "https://upload.wikimedia.org/wikipedia/commons/b/b5/National_University_of_Singapore_logo.svg", anno: "Training-free", badge: "HOT", level: 1, badgeColor: "#be123c" },
            { name: "PE-MIL", title: "Prompt-Enhanced MIL for Video Anomaly Detection", year: "2024", conf: "CVPR'24", type: "llm", anno: "Prompt-Enhanced" },
            { name: "TPWNG", title: "Temporal Preference Weakly-supervised VAD", year: "2024", conf: "CVPR'24", type: "llm", anno: "Weakly Supervised" },
            { name: "MULDE", title: "MULDE: Multi-Teacher Knowledge Distillation for VAD", year: "2024", conf: "CVPR'24", type: "llm", anno: "Multi-Teacher Distillation" },
            { name: "CUVA", title: "CUVA: A Causal Inference Benchmark for VAD Analysis", year: "2024", conf: "CVPR'24", type: "dataset", logo: "https://upload.wikimedia.org/wikipedia/commons/5/50/Emblem_of_CU.png", anno: "Causation" },
            { name: "PhyAD", title: "PhyAD: Physics-Grounded Video Anomaly Detection", year: "2024", conf: "CVPR'24", type: "dataset", anno: "Physics-Grounded" },
            { name: "AnomalyRuler", title: "AnomalyRuler: Logical Ruler Reasoning for VAD", year: "2024", conf: "ECCV'24", type: "llm", anno: "Ruler-based" },
            { name: "AdaCLIP", title: "AdaCLIP: Adaptive Alignment of Vision-Language Models", year: "2024", conf: "ECCV'24", type: "clip", anno: "Adaptive Alignment" },
            { name: "FedVAD", title: "FedVAD: Privacy-Preserving Federated VAD", year: "2024", conf: "ECCV'24", type: "llm", anno: "Privacy Protection" },
            { name: "HawkEye", title: "HawkEye: An Emotion-Oriented Dataset for VAD", year: "2024", conf: "ACM MM'24", type: "dataset", anno: "Emotion Analysis" },
            { name: "HAWK", title: "HAWK: Open-World Video Anomaly Detection Benchmark", year: "2024", conf: "NeurIPS'24", type: "dataset", anno: "Open-World" },
            { name: "VarCMP", title: "Variable-Context Modeling and Prediction for VAD", year: "2024", conf: "AAAI'24", type: "clip", anno: "Variable Context" },
            { name: "Fed-WAVAD", title: "Federated Weakly-supervised Video Anomaly Detection", year: "2024", conf: "AAAI'24", type: "clip", anno: "Federated Learning" },
            
            // 2025
            { name: "VERA", title: "VERA: Verbalized Learning for Video Anomaly Detection", year: "2025", conf: "CVPR'25", type: "llm", anno: "Verbalized Learning" },
            { name: "Holmes-VAU", title: "Holmes-VAU: Multi-Grained Reasoning for VAU", year: "2025", conf: "CVPR'25", type: "dataset", anno: "Multi-Grained" },
            { name: "Ex-VAD", title: "Ex-VAD: Explainable Fine-Grained Video Anomaly Detection", year: "2025", conf: "ICML'25", type: "llm", anno: "Fine-Grained" },
            { name: "VA-GPT", title: "VA-GPT: Token Sampling Paradigm for Video Anomaly Detection", year: "2025", conf: "ICCV'25", type: "dataset", anno: "Token Sampling" },
            { name: "HiProbe-VAD", title: "HiProbe: Hierarchical Probing for Multimodal VAD", year: "2025", conf: "ACM MM'25", type: "llm", anno: "Hierarchical Probing" },
            { name: "EventVAD", title: "EventVAD: Detection in Event-based Video Streams", year: "2025", conf: "ACM MM'25", type: "llm", anno: "Event-based" },
            { name: "Vad-R1", title: "Vad-R1: Perception-to-Cognition Reasoning Dataset", year: "2025", conf: "NeurIPS'25", type: "dataset", logo: "https://upload.wikimedia.org/wikipedia/commons/1/13/Peking_University_Logo.svg", anno: "Perception-to-Cognition", badge: "IMPORTANT", level: 1 },
            { name: "PANDA", title: "PANDA: Prompt Analysis and Reasoning for VAD", year: "2025", conf: "NeurIPS'25", type: "llm", anno: "Prompt Analysis" },
            { name: "URF-VAA", title: "URF-VAA: Uncertainty Refinement in Video Anomaly Analysis", year: "2025", conf: "NeurIPS'25", type: "llm", anno: "Uncertainty Refinement" },
            { name: "VADTree", title: "VADTree: Hierarchical Detection Tree for VAD", year: "2025", conf: "NeurIPS'25", type: "llm", anno: "Hierarchical Tree" },
            { name: "MoniTor", title: "MoniTor: A Systematic Paradigm for Monitor-based VAD", year: "2025", conf: "NeurIPS'25", type: "llm", anno: "Monitor Paradigm" },
            { name: "A2Seek", title: "A2Seek: Drone-view Benchmark and Graph-of-Thought for VAD", year: "2025", conf: "NeurIPS'25", type: "dataset", anno: "Drone-view & GoT" }
        ];

        // UI Components
        function Icon({ name, size = 16, className = "" }) {
            const icons = {
                Github: <path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/>,
                Close: <path d="M18 6 6 18M6 6l12 12" strokeWidth="2.5" stroke="currentColor" strokeLinecap="round" strokeLinejoin="round"/>,
                Sun: <path d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364-6.364l-.707.707M6.343 17.657l-.707.707m0-12.728l.707.707m11.314 11.314l.707.707M12 8a4 4 0 100 8 4 4 0 000-8z" strokeWidth="2" stroke="currentColor"/>,
                Moon: <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z" strokeWidth="2" stroke="currentColor"/>,
                Monitor: <path d="M3 5a2 2 0 012-2h14a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2V5zM8 21h8M12 17v4" strokeWidth="2" stroke="currentColor"/>
            };
            return (
                <svg viewBox="0 0 24 24" width={size} height={size} fill={["Github"].includes(name) ? "currentColor" : "none"} stroke={["Close", "Sun", "Moon", "Monitor"].includes(name) ? "currentColor" : "none"} className={className}>
                    {icons[name] || null}
                </svg>
            );
        }

        function BrandIcon({ name, size = 10 }) {
            if (name === "Arxiv") return (
                <div className="bg-[#ef4444]/20 border border-[#ef4444]/40 px-0.5 rounded-[1px] flex items-center justify-center shrink-0 shadow-sm transition-all hover:bg-[#ef4444]/40">
                    <img src="https://arxiv.org/static/browse/0.3.4/images/arxiv-logo-one-color-white.svg" alt="X" style={{ height: `${size-5}px` }} />
                </div>
            );
            return null;
        }

        function CuratorBadge({ badge, level, customColor }) {
            if (!badge) return null;
            return (
                <div className="badge-tab-tech-cut" style={{ 
                    backgroundColor: level === 1 ? (customColor || '#801a1a') : 'rgba(255,255,255,0.05)',
                    border: level === 1 ? 'none' : '1px solid var(--badge-border)'
                }}>
                    <span className="badge-text-flat" style={{ color: level === 1 ? 'white' : 'var(--text-muted)' }}>{badge}</span>
                </div>
            );
        }

        const PaperCard = memo(({ paper, onClick, position, isDarkMode }) => {
            const acc = ACCENTS[paper.type] || ACCENTS.llm;
            const confColor = CONF_THEMES[Object.keys(CONF_THEMES).find(k => paper.conf.includes(k))] || CONF_THEMES.DEFAULT;
            
            return (
                <div className="card-container relative flex flex-col items-center group transition-all" 
                     style={{ "--accent-color": acc.highlight, "--shadow-color": isDarkMode ? acc.glow : 'rgba(0,0,0,0.05)' }}>
                    <div className="node-connector" style={{ height: '10px', bottom: position === 'top' ? '-12px' : 'auto', top: position === 'bottom' ? '-12px' : 'auto' }} />
                    <div onClick={() => onClick(paper)} className="relative w-[180px] card-glass py-2.5 px-3 rounded-sm shadow-sm cursor-pointer animate-node overflow-hidden">
                        <div className={`accent-bar absolute top-0 left-0 w-[3px] h-full ${acc.accent} z-10 opacity-70`} />
                        <CuratorBadge badge={paper.badge} level={paper.level} customColor={paper.badgeColor} />
                        <div className="flex gap-2.5 items-center relative z-20">
                            <div className="w-[28px] h-[28px] shrink-0 flex items-center justify-center group-hover:scale-110 transition-transform duration-500">
                                {paper.logo && paper.logo.startsWith('http') ? (
                                    <img src={paper.logo} className={`max-w-full max-h-full object-contain`} />
                                ) : (
                                    <div className={`w-full h-full ${paper.logo || 'bg-slate-700'} opacity-20 rounded-full`} />
                                )}
                            </div>
                            <div className="flex flex-col min-w-0 flex-1">
                                <div className="flex items-center justify-between mb-0.5">
                                    <h4 className={`text-[10px] font-black tracking-tight leading-none truncate pr-1 group-hover:text-blue-400 transition-colors ${isDarkMode ? 'text-slate-100' : 'text-slate-800'}`}>{paper.name}</h4>
                                    <div className="flex items-center gap-1 shrink-0">
                                        <div className="flex items-center gap-1">
                                            {paper.arxiv && (
                                                <a href={paper.arxiv} target="_blank" rel="noopener noreferrer" onClick={(e) => e.stopPropagation()} className="opacity-40 hover:opacity-100 transition-opacity">
                                                    <BrandIcon name="Arxiv" size={12} />
                                                </a>
                                            )}
                                            {paper.github && (
                                                <a href={paper.github} target="_blank" rel="noopener noreferrer" onClick={(e) => e.stopPropagation()} className="opacity-40 hover:opacity-100 transition-opacity">
                                                    <Icon name="Github" size={10} className={isDarkMode ? 'text-white' : 'text-slate-900'} />
                                                </a>
                                            )}
                                        </div>
                                    </div>
                                </div>
                                <p className={`text-[7.5px] font-medium italic truncate mb-1 leading-tight ${isDarkMode ? 'text-slate-400' : 'text-slate-500'}`}>{paper.anno}</p>
                                <div className="flex items-center"><span className="text-[6.5px] font-black tracking-tighter uppercase leading-none opacity-60" style={{ color: confColor }}>{paper.conf}</span></div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        });

        function App() {
            const [activeItem, setActiveItem] = useState(null);
            const [theme, setTheme] = useState('dark');
            const [resolvedDarkMode, setResolvedDarkMode] = useState(true);
            const scrollRef = useRef(null);
            const COLUMN_WIDTH = 220; 

            useEffect(() => {
                const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
                const updateTheme = () => {
                    if (theme === 'dark') setResolvedDarkMode(true);
                    else if (theme === 'light') setResolvedDarkMode(false);
                    else setResolvedDarkMode(mediaQuery.matches);
                };
                updateTheme();
                mediaQuery.addEventListener('change', updateTheme);
                return () => mediaQuery.removeEventListener('change', updateTheme);
            }, [theme]);

            useEffect(() => { document.body.classList.toggle('light-theme', !resolvedDarkMode); }, [resolvedDarkMode]);

            useLayoutEffect(() => {
                const el = scrollRef.current;
                if (!el) return;
                const scrollToEnd = () => { el.scrollLeft = el.scrollWidth; };
                setTimeout(scrollToEnd, 500);
            }, []);

            // CANVAS LOGIC (UNCHANGED CORE)
            useEffect(() => {
                const canvas = document.getElementById('bg-canvas');
                if (!canvas) return;
                const ctx = canvas.getContext('2d');
                let width = canvas.width = window.innerWidth;
                let height = canvas.height = window.innerHeight;
                let raf, last = performance.now();
                const rand = (a, b) => a + Math.random() * (b - a);

                const lines = Array.from({ length: 65 }).map(() => ({
                    x: Math.random() * width, y: Math.random() * height, vx: rand(-1.4, -0.4),
                    len: rand(100, 350), hue: rand(180, 240), opacity: rand(0.05, 0.15)
                }));

                const particles = Array.from({ length: 100 }).map(() => ({
                    x: Math.random() * width, y: Math.random() * height, r: rand(0.5, 2),
                    vx: rand(-0.8, -0.3), vy: rand(-0.1, 0.1), phase: Math.random() * Math.PI * 2, opacity: rand(0.06, 0.2)
                }));

                let hoverSignal = null;
                const onHover = (e) => {
                    const card = e.target.closest('.card-container');
                    if (card) {
                        const rect = card.getBoundingClientRect();
                        hoverSignal = { x: rect.left + rect.width / 2, y: rect.top + rect.height / 2 };
                    }
                };
                const onLeave = (e) => { if (e.target.closest('.card-container')) hoverSignal = null; };
                document.addEventListener('mouseover', onHover);
                document.addEventListener('mouseout', onLeave);

                const loop = (now) => {
                    const dt = now - last; last = now;
                    ctx.clearRect(0, 0, width, height);
                    ctx.globalCompositeOperation = resolvedDarkMode ? 'lighter' : 'multiply';
                    lines.forEach(s => {
                        s.x += s.vx * dt * 0.05 * (hoverSignal ? 1.5 : 1);
                        if (s.x + s.len < 0) { s.x = width; s.y = Math.random() * height; }
                        ctx.strokeStyle = resolvedDarkMode ? `hsla(${s.hue}, 40%, 60%, ${s.opacity})` : `hsla(${s.hue}, 20%, 30%, ${s.opacity})`;
                        ctx.lineWidth = 1; ctx.beginPath(); ctx.moveTo(s.x, s.y); ctx.lineTo(s.x + s.len, s.y); ctx.stroke();
                    });
                    particles.forEach(p => {
                        p.x += p.vx; p.y += p.vy + Math.sin(now * 0.001 + p.phase) * 0.2;
                        if (p.x < -20) p.x = width + 20;
                        ctx.fillStyle = resolvedDarkMode ? `rgba(255, 255, 255, ${p.opacity})` : `rgba(100, 116, 139, ${p.opacity})`;
                        ctx.beginPath(); ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2); ctx.fill();
                    });
                    if (hoverSignal) {
                        ctx.strokeStyle = resolvedDarkMode ? 'rgba(255, 255, 255, 0.08)' : 'rgba(44, 74, 112, 0.05)';
                        ctx.lineWidth = 0.6; ctx.beginPath();
                        ctx.moveTo(hoverSignal.x, hoverSignal.y);
                        ctx.quadraticCurveTo(hoverSignal.x - 200, hoverSignal.y - 150, hoverSignal.x - 600, hoverSignal.y + 100);
                        ctx.stroke();
                    }
                    raf = requestAnimationFrame(loop);
                };
                raf = requestAnimationFrame(loop);
                return () => { cancelAnimationFrame(raf); document.removeEventListener('mouseover', onHover); document.removeEventListener('mouseout', onLeave); };
            }, [resolvedDarkMode]);

            const timeline = useMemo(() => {
                const months = ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"];
                const columns = [];
                ["2023", "2024", "2025"].forEach(y => {
                    for(let m = 1; m <= 12; m++) {
                        const papers = PAPER_DATA.filter(p => p.year === y && (CONF_MONTHS[Object.keys(CONF_MONTHS).find(k => p.conf.includes(k))] || 6) === m);
                        if (papers.length === 0) continue;
                        const topPapers = papers.filter(p => p.type !== 'dataset');
                        const bottomPapers = papers.filter(p => p.type === 'dataset');
                        const topChunks = []; for(let i=0; i<topPapers.length; i+=5) topChunks.push(topPapers.slice(i, i+5));
                        const bottomChunks = []; for(let i=0; i<bottomPapers.length; i+=5) bottomChunks.push(bottomPapers.slice(i, i+5));
                        const numCols = Math.max(topChunks.length, bottomChunks.length);
                        for(let i = 0; i < numCols; i++) {
                            columns.push({ date: `${months[m-1]} ${y}`, year: y, top: topChunks[i] || [], bottom: bottomChunks[i] || [], isFirstInMonth: i === 0, id: `${y}-${m}-${i}` });
                        }
                    }
                });
                return columns;
            }, []);

            return (
                <div className="h-screen w-full flex flex-col relative overflow-hidden">
                    <div className="top-left-bar">
                        <button onClick={() => setTheme(prev => prev === 'dark' ? 'light' : prev === 'light' ? 'system' : 'dark')} className="theme-toggle-btn">
                            <Icon name={theme === 'dark' ? "Moon" : theme === 'light' ? "Sun" : "Monitor"} size={16} />
                        </button>
                    </div>

                    <div className="top-right-bar">
                        <div className="github-link-group relative flex items-center">
                            <div className="star-tooltip">Give us a Star</div>
                            <a href={GITHUB_LINK} target="_blank">
                                <Icon name="Github" size={28} className={`${resolvedDarkMode ? 'text-white/60' : 'text-slate-800/60'} transition-all duration-300 hover:rotate-12 hover:scale-110`} />
                            </a>
                        </div>
                    </div>

                    <div className="fixed top-12 w-full flex flex-col items-center pointer-events-none z-50">
                        <h1 className="atlas-handwritten-title">Tracing Video Anomaly Understanding</h1>
                    </div>

                    <div className="fixed top-44 w-full flex justify-center gap-4 z-50">
                        {['2023', '2024', '2025'].map(y => (
                            <button key={y} onClick={() => scrollRef.current.scrollLeft = timeline.findIndex(t => t.year === y) * COLUMN_WIDTH + (window.innerWidth/3)} className="nav-btn">{y}</button>
                        ))}
                    </div>

                    <main ref={scrollRef} className="flex-1 panorama-viewport no-scrollbar relative pt-[120px] pb-[60px]">
                        <div className="inline-flex h-full items-stretch pl-[45vw] pr-[10vw] relative" style={{ minWidth: `${timeline.length * COLUMN_WIDTH + 100}px` }}>
                            <div className="timeline-spine" />
                            <div className="absolute inset-0 flex items-center pointer-events-none select-none z-[-10]">
                                {['2023', '2024', '2025'].map(y => {
                                    const firstIdx = timeline.findIndex(t => t.year === y);
                                    if (firstIdx === -1) return null;
                                    const verticalStagger = (parseInt(y) % 2 === 0) ? '40%' : '78%';
                                    return <div key={y} className="absolute flex justify-center items-center" style={{ left: `${firstIdx * COLUMN_WIDTH}px`, width: `${timeline.filter(t => t.year === y).length * COLUMN_WIDTH}px`, height: '100%', top: verticalStagger, transform: 'translateY(-50%)' }}><span className="bg-year-watermark">{y}</span></div>;
                                })}
                            </div>
                            {timeline.map((seg, idx) => (
                                <div key={seg.id} className="absolute w-[220px] grid grid-rows-[65fr_20px_35fr] h-full" style={{ left: `${idx * COLUMN_WIDTH}px` }}>
                                    <div className="flex flex-col-reverse items-center justify-start gap-2 pb-4 relative z-10 overflow-visible">
                                        {seg.top.map((p, i) => <PaperCard key={i} paper={p} position="top" onClick={() => setActiveItem(p)} isDarkMode={resolvedDarkMode} />)}
                                    </div>
                                    <div className="flex items-center justify-center relative">
                                        {seg.isFirstInMonth ? (
                                            <div className={`${resolvedDarkMode ? 'bg-slate-800 border-slate-700' : 'bg-white border-slate-200'} border px-2 py-0.5 rounded shadow-lg z-20 flex items-center justify-center h-[18px]`}>
                                                <span className={`${resolvedDarkMode ? 'text-slate-200' : 'text-slate-800'} text-[7.5px] font-black uppercase tracking-tighter leading-none`}>{seg.date}</span>
                                            </div>
                                        ) : (
                                            <div className={`w-1.5 h-1.5 ${resolvedDarkMode ? 'bg-slate-600' : 'bg-slate-300'} rounded-full z-20`} />
                                        )}
                                    </div>
                                    <div className="flex flex-col items-center justify-start gap-2 pt-4 relative z-10 overflow-visible">
                                        {seg.bottom.map((p, i) => <PaperCard key={i} paper={p} position="bottom" onClick={() => setActiveItem(p)} isDarkMode={resolvedDarkMode} />)}
                                    </div>
                                </div>
                            ))}
                        </div>
                    </main>

                    <div className="fixed bottom-10 w-full flex justify-center gap-12 z-50">
                        {Object.entries(ACCENTS).map(([k,v]) => (
                            <div key={k} className="flex items-center gap-2.5 cursor-default group opacity-60 hover:opacity-100 transition-opacity">
                                <div className={`w-3.5 h-1 ${v.accent} rounded-[1px] transition-all group-hover:scale-x-150 shadow-[0_0_10px_rgba(255,255,255,0.2)]`} />
                                <span className={`text-[9px] font-black uppercase tracking-widest ${resolvedDarkMode ? 'text-slate-300' : 'text-slate-700'}`}>{v.label}</span>
                            </div>
                        ))}
                    </div>

                    {activeItem && (
                        <div className="fixed inset-0 z-[100] bg-black/80 backdrop-blur-md flex items-center justify-center p-6 animate-in fade-in duration-300" onClick={() => setActiveItem(null)}>
                            <div className="modal-container w-full max-w-[460px] shadow-2xl rounded-xl overflow-hidden animate-in zoom-in-95 relative" onClick={e => e.stopPropagation()}>
                                <div className="modal-close-trigger" onClick={() => setActiveItem(null)}><Icon name="Close" size={16} /></div>
                                <div className="h-1.5 w-full shadow-sm" style={{ backgroundColor: (ACCENTS[activeItem.type] || ACCENTS.llm).highlight }} />
                                <div className="p-10 relative">
                                    <div className="mb-6">
                                        <div className="flex items-center gap-2 mb-4">
                                            <span className={`px-2.5 py-1 text-[8px] font-black uppercase tracking-widest rounded border ${resolvedDarkMode ? 'bg-slate-800 text-slate-400 border-slate-700' : 'bg-slate-100 text-slate-600 border-slate-200'}`}>{activeItem.conf} // {activeItem.year}</span>
                                            {activeItem.badge && <span className="px-2 py-1 text-[8px] font-black uppercase rounded text-white" style={{ backgroundColor: activeItem.badgeColor || '#801a1a' }}>{activeItem.badge}</span>}
                                        </div>
                                        <h3 className={`text-2xl font-black italic tracking-tighter leading-[1.1] mb-2 ${resolvedDarkMode ? 'text-white' : 'text-slate-900'}`}>{activeItem.title}</h3>
                                        <p className="text-xs font-bold text-slate-400 mb-6 italic">{activeItem.anno}</p>
                                        {activeItem.image && <div className="mt-4 mb-6 rounded-lg overflow-hidden bg-black/20 shadow-inner"><img src={activeItem.image} className="w-full h-auto block" /></div>}
                                    </div>
                                    <div className={`py-6 border-y mb-8 italic text-[13px] text-justify leading-relaxed ${resolvedDarkMode ? 'border-slate-800 text-slate-300' : 'border-slate-100 text-slate-700'}`}>
                                        {activeItem.desc || `This contribution explores the intersection of perception and logic in video anomaly understanding.` }
                                    </div>
                                    <div className="grid grid-cols-2 gap-4">
                                        <a href={activeItem.arxiv || "#"} target="_blank" className={`flex items-center justify-center py-3.5 text-[10px] font-black uppercase tracking-widest transition-all rounded-lg ${resolvedDarkMode ? 'bg-white text-slate-900 hover:bg-slate-200' : 'bg-slate-900 text-white hover:bg-slate-800'}`}>READ ARCHIVE</a>
                                        <a href={activeItem.github || "#"} target="_blank" className={`flex items-center justify-center py-3.5 border-2 text-[10px] font-black uppercase tracking-widest transition-all rounded-lg ${resolvedDarkMode ? 'border-slate-700 text-white hover:bg-slate-800' : 'border-slate-200 text-slate-900 hover:bg-slate-50'}`}>SOURCE CODE</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>